<!DOCTYPE html>
<html class="limited-width larger-font legacy-styles" prefix="og: http://ogp.me/ns#" lang="en">
<head>
  <meta charset="utf-8">
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>CSV is not a standard | Chris Warrick</title>
  <link href="/assets/css/bootstrap-kw.css?md5=01372f7811891028774e5f5d94b5609a" rel="stylesheet" type="text/css">
  
  <link href="/assets/css/legacy.css?md5=42449d92ececd41a057e53cf8c8db633" rel="stylesheet" type="text/css">
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Source+Sans+3:ital,wght@0,200..900;1,200..900&family=Source+Serif+4:opsz,wght@8..60,200..900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css"
        integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/baguettebox.js/1.10.0/baguetteBox.min.css"
        integrity="sha256-FqCzNnnyXl5HxHMdb+RQ/RV/X7fqfPcQYy+G2gFL3Xk=" crossorigin="anonymous">
  <meta name="theme-color" content="#00aadd">
  <meta name="generator" content="Chris Warrick’s Yet Another Blog Generator">
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/rss.xml">
  <link rel="canonical" href="https://chriswarrick.com/blog/2017/04/07/csv-is-not-a-standard/">
  <link rel="icon" type="image/x-icon" href="/favicon.ico" sizes="16x16 32x32 48x48 64x64 128x128 256x256">
  <link rel="icon" type="image/png" href="/assets/img/logo512.png">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  <link rel="prev" href="/blog/2016/12/28/5-months-with-a-macbook-pro-beautiful-machine-that-just-works/" type="text/html">
  <link rel="next" href="/blog/2017/06/08/apples-new-pricing-strategy-dont-buy-the-12-macbook/" type="text/html">
  
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<nav class="navbar navbar-expand-md navbar-kw mb-4">
  <div class="container">
    <a class="navbar-brand" href="/">
      <img src="/assets/img/logo.png" srcset="/assets/img/logo2x.png 2x" alt="Chris Warrick" id="logo"><span
        id="blog-title">Chris Warrick</span>
    </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar-links" aria-controls="navbar-links" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbar-links">
      <ul class="navbar-nav mr-auto">
        
        
          <li class="nav-item">
            <a href="/contact/" class="nav-link">Contact</a>
          </li>
        
        
        
          <li class="nav-item">
            <a href="/projects/" class="nav-link">Projects</a>
          </li>
        
        
        
          <li class="nav-item">
            <a href="/guides/" class="nav-link">Guides</a>
          </li>
        
        
        
          <li class="nav-item">
            <a href="/blog/" class="nav-link">Archives</a>
          </li>
        
        
        
          <li class="nav-item">
            <a href="/blog/tags/" class="nav-link">Tags</a>
          </li>
        
        
      </ul>
    </div>
  </div>
</nav>
<div class="container" id="content" role="main">
  <div class="body-content">
    <div id="cookiebox"></div>
    


<article class="post-text h-entry hentry postpage postbox" itemscope="itemscope" itemtype="http://schema.org/Article">
  
<header class="page-header">
  <h1 class="p-name entry-title" itemprop="headline name">
    <a href="/blog/2017/04/07/csv-is-not-a-standard/" class="u-url">CSV is not a standard</a>
  </h1>

  <div class="metadata">
    <a href="/blog/2017/04/07/csv-is-not-a-standard/" rel="bookmark" class="u-published">
      <time class="published dt-published" datetime="2017-04-07T20:00:00.0000000&#x2B;02:00" itemprop="datePublished" title="07 April 2017 20:00">07 April 2017 20:00</time>
    
    </a>
    <ul itemprop="keywords" class="tags list-inline">
      <li class="list-inline-item category-bubble">
        <a class="tag p-category badge rounded-pill" style="background-color: #ff5dd7 !important" href="/blog/tags/cat_programming">Programming</a>
        </li>
      
      <li class="list-inline-item">
        <a class="tag p-category badge rounded-pill" href="/blog/tags/csv" rel="tag">CSV</a>
      </li>
      
      <li class="list-inline-item">
        <a class="tag p-category badge rounded-pill" href="/blog/tags/excel" rel="tag">Excel</a>
      </li>
      
      <li class="list-inline-item">
        <a class="tag p-category badge rounded-pill" href="/blog/tags/microsoft" rel="tag">Microsoft</a>
      </li>
      
      <li class="list-inline-item">
        <a class="tag p-category badge rounded-pill" href="/blog/tags/microsoft-office" rel="tag">Microsoft Office</a>
      </li>
      
      <li class="list-inline-item"><a class="badge bg-primary-subtle text-primary-emphasis" href="https://go.chriswarrick.com/csv" title="Short link to this article (go.chriswarrick.com/csv)"><i class="fa fa-link"></i> csv</a></li>
    </ul>
    
  </div>
</header>

  <div class="e-content entry-content" itemprop="articleBody text">
    
      <div class="lead">
        
<p>CSV is not a standard. What does that really mean for anyone using that format?
The file’s recipient may be unable to read it the way you intended. Separators,
decimal marks, escaping and encodings are all problems — and Excel does them
all pretty badly.</p>

      </div>
    
    
<p>So first, some people might claim that <a class="reference external" href="http://www.ietf.org/rfc/rfc4180.txt">RFC 4180</a> is the CSV standard. Those
people also have not read the document they’re referring to. It states:</p>
<blockquote>
<p>This memo provides information for the Internet community.  It does
not specify an Internet standard of any kind.</p>
</blockquote>
<p>The problem with this is the fact that a <code class="docutils literal">.csv</code> file does not mean much. There
are a few problems. The first question is,</p>
<blockquote>
<p>What is the field separator? Is it a comma or a semicolon?</p>
</blockquote>
<p>Hey, wait a minute, doesn’t the file format/extension stand for
<em>comma-separated values</em>? Yes, it does. But that does not matter in the
slightest. You see, Microsoft Excel — which most people will use to read/write
their CSV files — makes this decision based on the user locale settings. If the
OS is set to a locale where the comma is the <a class="reference external" href="https://en.wikipedia.org/wiki/Decimal_mark#Hindu.E2.80.93Arabic_numeral_system">decimal mark</a> (eg. most of
Europe), the list separator is set to <code class="docutils literal">;</code> instead of <code class="docutils literal">,</code> — and Excel uses
that.</p>
<p>Of course, there’s also the TSV data format — those are tab-separated values.
And some people might name their TSV files <code class="docutils literal">.csv</code>.</p>
<p>To read files saved in a different locale, or with a different separator, Excel
users need to change the file extension to <code class="docutils literal">.txt</code>, or go to Data → Get
External Data → From Text <a class="reference external" href="https://support.office.com/en-us/article/Text-Import-Wizard-c5b02af6-fda1-4440-899f-f78bafe41857">(documentation)</a> and use the import wizard. You
can’t double-click on files.</p>
<p>On a side note, Apple Numbers guesses the format — one of the few things it
gets right. LibreOffice always asks the user to pick import settings, but by
default it uses tab AND comma AND semicolon for CSV files, which brings its own
host of problems.</p>
<p>Here’s a quick test:</p>
<blockquote>
<p>What does <code class="docutils literal">foo;bar,baz;quux</code> mean? What about <code class="docutils literal">foo,bar;baz,quux</code>?</p>
</blockquote>
<ul class="simple">
<li><p>LibreOffice assumes it’s (Chinese) UTF-16 text, but after telling it the real encoding, both
files contain <strong>4 columns</strong>.</p></li>
<li><p>Microsoft Excel says one of the files contains <strong>3 columns</strong> and the other contains <strong>2 columns</strong>
(which is which depends on locale)</p></li>
<li><p>Apple Numbers says the first file contains <strong>3 columns</strong> and the other
contains <strong>2 columns</strong> if set to English, and both files contain <strong>3
columns</strong> if set to Polish.</p></li>
</ul>
<p>But let’s get back to gotchas:</p>
<blockquote>
<p>What is the decimal mark? Is it a dot or a comma?</p>
</blockquote>
<p>That’s a direct consequence of the previous question. However, one can’t simply
assume <code class="docutils literal">comma/dot</code> and <code class="docutils literal">semicolon/comma</code>, because users might do crazy
stuff.</p>
<blockquote>
<p>What is used to escape rows containing the field separator? Quotes?
Backslashes?  What is used to escape the escape character?</p>
</blockquote>
<p>Excel, for example, puts some things in <code class="docutils literal">&quot;quotes&quot;</code>. If a literal quote
character appears in the spreadsheet, it’s represented as <code class="docutils literal">&quot;&quot;</code>, and
the entire cell is quoted as well. But there might be programs that use
backslashes for escapes, or even bad code that does not consider the need of
escaping like this, with tragic results.</p>
<p>There’s still one more thing to cover: encodings. You see, even though the TSV
format effectively solves the issues I named before, both CSV and TSV suffer
from one problem:</p>
<blockquote>
<p>Which encoding to use when reading this file?</p>
</blockquote>
<p>I already mentioned that LibreOffice believed my sample file was UTF-16,
containing Chinese text — in reality, this file was UTF-8 (or ASCII).</p>
<p>What does Microsoft Excel do then? It looks like it follows <em>System locale for
non-Unicode programs</em>. While there is an encoding option hidden in the Save
dialog, it does not seem to affect the output. So what does that mean? You
can’t expect a CSV file that contains characters outside of your system locale
— or outside of ASCII if you’re working with people around the world — to look
right. Unless you’re on <a class="reference external" href="https://answers.microsoft.com/en-us/msoffice/forum/msoffice_install-mso_win10/announcing-october-feature-update-for-office-2016/927eea90-eea3-479a-a78a-45f7612460e1">Excel 2016</a> and Office 365 — if you have the October
2016 update, you can read and write UTF-8 files. But if you’re using an older
version of Excel, or you’re using a non-Office 365 license, tough luck.</p>
<p>So, to reiterate: CSV can mean a lot of things. And you can’t trust it to work
well most of the time, unless you’re dealing with people in one country, all
using the same locale settings and software. Which is pretty unlikely. TSV
can work around most of the problems, but encodings are still troublesome.</p>

  </div>
</article>




  <aside class="postpromonav">
    <nav>
      <ul class="pager hidden-print">
        
          <li class="previous">
            <a href="/blog/2016/12/28/5-months-with-a-macbook-pro-beautiful-machine-that-just-works/" rel="prev" class="btn btn-outline-secondary"
               title="5 months with a MacBook Pro: beautiful machine that just works">← Previous post</a>
          </li>
        
        
          <li class="next">
            <a href="/blog/2017/06/08/apples-new-pricing-strategy-dont-buy-the-12-macbook/" rel="prev" class="btn btn-outline-secondary"
               title="Apple&#x2019;s new pricing strategy: don&#x27;t buy the 12&#x2033; MacBook">Next post →</a>
          </li>
        
      </ul>
    </nav>
  </aside>



  <section class="comments">
    <div data-title="CSV is not a standard" id="isso-thread"></div>
    <script src="https://isso.chriswarrick.com/js/embed.min.js" data-isso="https://isso.chriswarrick.com/"
            data-isso-lang="en" data-isso-require-author="true" data-isso-require-email="true" data-isso-gravatar="true"
            data-isso-avatar="false" data-isso-css="false" data-isso-vote="false"
            data-isso-reply-notifications="true"></script>
  </section>



    <script src="https://isso.chriswarrick.com/js/count.min.js" data-isso="https://isso.chriswarrick.com/"
            data-isso-lang="en"></script>
    <nav id="footer-links">
      <div class="row">
        <div class="col-sm-4">
          <h6>Blog</h6>
          <ul>
            <li class="nav-item">
              <a href="/blog/" class="nav-link">Archives</a>
            </li>
            <li class="nav-item">
              <a href="/blog/tags/" class="nav-link">Tags</a>
            </li>
            <li class="nav-item">
              <a href="/listings/" class="nav-link">Listings</a>
            </li>
            <li class="nav-item">
              <a href="/rss.xml" class="nav-link">RSS Feed</a>
            </li>
          </ul>
        </div>
        <div class="col-sm-4">
          <h6>Projects and Work</h6>
          <ul>
            <li class="nav-item">
              <a href="/projects/" class="nav-link">Projects</a>
            </li>
            <li class="nav-item">
              <a href="/guides/" class="nav-link">Guides</a>
            </li>
            <li class="nav-item">
              <a href="/kwbot/" class="nav-link">KwBot</a>
            </li>
            <li class="nav-item">
              <a href="/blog/tags/cat_python" class="nav-link">Posts about Python</a>
            </li>
          </ul>
        </div>
        <div class="col-sm-4">
          <h6>Me</h6>
          <ul>
            <li class="nav-item">
              <a href="/contact/" class="nav-link">Contact</a>
            </li>
            <li class="nav-item">
              <a href="/brand/" class="nav-link">Brand</a>
            </li>
            <li class="nav-item">
              <a href="https://twitter.com/Kwpolska" class="nav-link">Twitter</a>
            </li>
            <li class="nav-item">
              <a href="https://github.com/Kwpolska" class="nav-link">GitHub</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>
    <footer id="footer">
      <p>this site uses cookies.<br>by using this site, you agree to our <a href="/privacy/">cookie and privacy policy</a>.</p>
<p>powered by <strong><a href="https://github.com/Kwpolska/YetAnotherBlogGenerator">Yet Another Blog Generator</a></strong>,
  <a href="https://nginx.org/">nginx</a>
  and <a href="https://hetzner.cloud/?ref=Qy1lehF8PwzP">Hetzner Cloud</a><br>
  copyright © 2009–2026 <a href="/contact/">Chris Warrick</a><br>
  license: <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA</a>, unless stated otherwise</p>
    </footer>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.min.js"
        integrity="sha384-G/EV+4j2dNv+tEPo3++6LCgdCROaejBqfUeNjuKAiuXbjrxilcCdDz6ZAVfHWe1Y" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/baguettebox.js/1.11.0/baguetteBox.min.js"
        integrity="sha256-yQGjQhFs3LtyiN5hhr3k9s9TWZOh/RzCkD3gwwCKlkg=" crossorigin="anonymous"></script>
<script src="/assets/js/all.js?md5=ace0b6fcf11bcff218eb3f4c28d3823b"></script>
<script>
  baguetteBox.run('div#content', {
    ignoreClass: 'islink',
    captions: function (element) {
      return element.getElementsByTagName('img')[0].alt;
    }
  });
</script><!-- Matomo -->
<script>
  var _paq = window._paq = window._paq || [];
  /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function () {
    var u = "//matomo.chriswarrick.com/";
    _paq.push(['setTrackerUrl', u + 'matomo.php']);
    _paq.push(['setSiteId', '1']);
    var d = document, g = d.createElement('script'), s = d.getElementsByTagName('script')[0];
    g.async = true;
    g.src = u + 'matomo.js';
    s.parentNode.insertBefore(g, s);
  })();
</script><!-- End Matomo Code -->
</body>
</html>
