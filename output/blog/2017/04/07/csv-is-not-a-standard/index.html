<html prefix="
og: http://ogp.me/ns#
article: http://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="CSV is not a standard.">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>CSV is not a standard | Chris Warrick</title>
<link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
<link href="/assets/css/all.css" rel="stylesheet" type="text/css">
<link rel="alternate" type="application/rss+xml" title="RSS (en)" href="/rss.xml">
<link rel="alternate" type="application/rss+xml" title="RSS (pl)" href="/pl/rss.xml">
<link rel="canonical" href="https://chriswarrick.com/blog/2017/04/07/csv-is-not-a-standard/">
<link rel="icon" type="image/x-icon" href="/favicon.ico" sizes="16x16 32x32 48x48 64x64 128x128 256x256">
<link rel="icon" type="image/png" href="/assets/img/logo512.png">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
<!--[if lt IE 9]><script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script><![endif]--><meta name="application-name" content="Chris Warrick">
<meta name="msapplication-starturl" content="https://chriswarrick.com/">
<meta name="msapplication-navbutton-color" content="#00aadd">
<meta name="theme-color" content="#00aadd">
<meta name="generator" content="Nikola (getnikola.com)">
<meta name="description" itemprop="description" content="CSV is not a standard.">
<meta name="author" content="Chris Warrick">
<link rel="prev" href="/blog/2016/12/28/5-months-with-a-macbook-pro-beautiful-machine-that-just-works/" title="5 months with a MacBook Pro: beautiful machine that just works" type="text/html">
<link rel="next" href="/blog/2017/04/09/python-project-template-structure-and-automation/" title="Structuring and automating a Python project with the Python Project Template" type="text/html">
<meta property="og:site_name" content="Chris Warrick">
<meta property="og:title" content="CSV is not a standard">
<meta property="og:url" content="https://chriswarrick.com/blog/2017/04/07/csv-is-not-a-standard/">
<meta property="og:description" content="CSV is not a standard.">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2017-04-07T20:00:00+02:00">
<meta property="article:tag" content="CSV">
<meta property="article:tag" content="Excel">
<meta property="article:tag" content="Microsoft">
<meta property="article:tag" content="Microsoft Office">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@Kwpolska">
<link rel="alternate" hreflang="pl" href="/pl/blog/2017/04/07/csv-is-not-a-standard/">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-kw navbar-static-top" role="navigation"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-kw-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://chriswarrick.com/">
            <img src="/assets/img/logo.png" srcset="/assets/img/logo2x.png 2x" alt="Chris Warrick" id="logo"><span id="blog-title">Chris Warrick</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse navbar-kw-collapse">
            <ul class="nav navbar-nav">
<li>
<a href="/blog/">Archives</a>
                </li>
<li>
<a href="/blog/tags/">Tags</a>
                </li>
<li>
<a href="/contact/">Contact</a>
                </li>
<li>
<a href="/brand/">Brand</a>
                </li>
<li>
<a href="/kwbot/">KwBot</a>
                </li>
<li>
<a href="/projects/">Projects</a>
                </li>
<li>
<a href="/guides/">Guides</a>
                </li>
<li>
<a href="/search/">Search</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<li>            </li>
<li><a href="https://chriswarrick.com/pl/" rel="alternate" hreflang="pl">Polski</a></li>

                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
        <div id="cookiecontainer"></div>
            
<article class="post-text h-entry hentry postpage postbox" itemscope="itemscope" itemtype="http://schema.org/Article"><header class="page-header"><h1 class="p-name entry-title" itemprop="headline name">
    <a href="/blog/2017/04/07/csv-is-not-a-standard/" class="u-url">CSV is not a standard</a>
    </h1>

    <div class="metadata">
<a href="/blog/2017/04/07/csv-is-not-a-standard/" rel="bookmark" class="u-published"><time class="published dt-published" datetime="2017-04-07T20:00:00+02:00" itemprop="datePublished" title="2017-04-07 20:00">2017-04-07 20:00</time></a>
        <ul itemprop="keywords" class="tags">
<li class="section-bubble" style="background-color: #00b1a1"><a href="/programming/">Programming</a></li>
           <li><a class="tag p-category" href="/blog/tags/csv/" rel="tag">CSV</a></li>
           <li><a class="tag p-category" href="/blog/tags/excel/" rel="tag">Excel</a></li>
           <li><a class="tag p-category" href="/blog/tags/microsoft/" rel="tag">Microsoft</a></li>
           <li><a class="tag p-category" href="/blog/tags/microsoft-office/" rel="tag">Microsoft Office</a></li>
        
<li class="shortlink-bubble"><a href="https://go.chriswarrick.com/csv" title="Short link to this article (go.chriswarrick.com/csv)"><i class="fa fa-link"></i> csv</a></li>        </ul>
</div>
    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div class="lead"><div>
<p>CSV is not a standard. What does that really mean for anyone using that format?
The file’s recipient may be unable to read it the way you intended. Separators,
decimal marks, escaping and encodings are all problems — and Excel does them
all pretty badly.</p>
</div></div>
<p>So first, some people might claim that <a class="reference external" href="http://www.ietf.org/rfc/rfc4180.txt">RFC 4180</a> is the CSV standard. Those
people also have not read the document they’re referring to. It states:</p>
<blockquote>
This memo provides information for the Internet community.  It does
not specify an Internet standard of any kind.</blockquote>
<p>The problem with this is the fact that a <tt class="docutils literal">.csv</tt> file does not mean much. There
are a few problems. The first question is,</p>
<blockquote>
What is the field separator? Is it a comma or a semicolon?</blockquote>
<p>Hey, wait a minute, doesn’t the file format/extension stand for
<em>comma-separated values</em>? Yes, it does. But that does not matter in the
slightest. You see, Microsoft Excel — which most people will use to read/write
their CSV files — makes this decision based on the user locale settings. If the
OS is set to a locale where the comma is the <a class="reference external" href="https://en.wikipedia.org/wiki/Decimal_mark#Hindu.E2.80.93Arabic_numeral_system">decimal mark</a> (eg. most of
Europe), the list separator is set to <tt class="docutils literal">;</tt> instead of <tt class="docutils literal">,</tt> — and Excel uses
that.</p>
<p>Of course, there’s also the TSV data format — those are tab-separated values.
And some people might name their TSV files <tt class="docutils literal">.csv</tt>.</p>
<p>To read files saved in a different locale, or with a different separator, Excel
users need to change the file extension to <tt class="docutils literal">.txt</tt>, or go to Data → Get
External Data → From Text <a class="reference external" href="https://support.office.com/en-us/article/Text-Import-Wizard-c5b02af6-fda1-4440-899f-f78bafe41857">(documentation)</a> and use the import wizard. You
can’t double-click on files.</p>
<p>On a side note, Apple Numbers guesses the format — one of the few things it
gets right. LibreOffice always asks the user to pick import settings, but by
default it uses tab AND comma AND semicolon for CSV files, which brings its own
host of problems.</p>
<p>Here’s a quick test:</p>
<blockquote>
What does <tt class="docutils literal">foo;bar,baz;quux</tt> mean? What about <tt class="docutils literal">foo,bar;baz,quux</tt>?</blockquote>
<ul class="simple">
<li>LibreOffice assumes it’s (Chinese) UTF-16 text, but after telling it the real encoding, both
files contain <strong>4 columns</strong>.</li>
<li>Microsoft Excel says one of the files contains <strong>3 columns</strong> and the other contains <strong>2 columns</strong>
(which is which depends on locale)</li>
<li>Apple Numbers says the first file contains <strong>3 columns</strong> and the other
contains <strong>2 columns</strong> if set to English, and both files contain <strong>3
columns</strong> if set to Polish.</li>
</ul>
<p>But let’s get back to gotchas:</p>
<blockquote>
What is the decimal mark? Is it a dot or a comma?</blockquote>
<p>That’s a direct consequence of the previous question. However, one can’t simply
assume <tt class="docutils literal">comma/dot</tt> and <tt class="docutils literal">semicolon/comma</tt>, because users might do crazy
stuff.</p>
<blockquote>
What is used to escape rows containing the field separator? Quotes?
Backslashes?  What is used to escape the escape character?</blockquote>
<p>Excel, for example, puts some things in <tt class="docutils literal">"quotes"</tt>. If a literal quote
character appears in the spreadsheet, it’s represented as <tt class="docutils literal">""</tt>, and
the entire cell is quoted as well. But there might be programs that use
backslashes for escapes, or even bad code that does not consider the need of
escaping like this, with tragic results.</p>
<p>There’s still one more thing to cover: encodings. You see, even though the TSV
format effectively solves the issues I named before, both CSV and TSV suffer
from one problem:</p>
<blockquote>
Which encoding to use when reading this file?</blockquote>
<p>I already mentioned that LibreOffice believed my sample file was UTF-16,
containing Chinese text — in reality, this file was UTF-8 (or ASCII).</p>
<p>What does Microsoft Excel do then? It looks like it follows <em>System locale for
non-Unicode programs</em>. While there is an encoding option hidden in the Save
dialog, it does not seem to affect the output. So what does that mean? You
can’t expect a CSV file that contains characters outside of your system locale
— or outside of ASCII if you’re working with people around the world — to look
right. Unless you’re on <a class="reference external" href="https://answers.microsoft.com/en-us/msoffice/forum/msoffice_install-mso_win10/announcing-october-feature-update-for-office-2016/927eea90-eea3-479a-a78a-45f7612460e1">Excel 2016</a> and Office 365 — if you have the October
2016 update, you can read and write UTF-8 files. But if you’re using an older
version of Excel, or you’re using a non-Office 365 license, tough luck.</p>
<p>So, to reiterate: CSV can mean a lot of things. And you can’t trust it to work
well most of the time, unless you’re dealing with people in one country, all
using the same locale settings and software. Which is pretty unlikely. TSV
can work around most of the problems, but encodings are still troublesome.</p>
</div>
    </article>
</div>
    <aside class="postpromonav"><nav><ul class="pager hidden-print">
<li class="previous">
                <a href="/blog/2016/12/28/5-months-with-a-macbook-pro-beautiful-machine-that-just-works/" rel="prev" title="5 months with a MacBook Pro: beautiful machine that just works">Previous post</a>
            </li>
            <li class="next">
                <a href="/blog/2017/04/09/python-project-template-structure-and-automation/" rel="next" title="Structuring and automating a Python project with the Python Project Template">Next post</a>
            </li>
        </ul></nav></aside><section class="comments"><h2>Comments</h2>
                        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="kwpolska",
            disqus_url="https://chriswarrick.com/blog/2017/04/07/csv-is-not-a-standard/",
        disqus_title="CSV is not a standard",
        disqus_identifier="cache/posts/2017/04/07/csv-is-not-a-standard.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        </section><script>var disqus_shortname="kwpolska";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script>
</div>
        <!--End of body content-->

        <footer class="site-footer"><p><a href="/cookies/">this site uses
cookies.</a><br>by using this site, you agree to our cookie policy.</p>
<p>
powered by <strong><a href="https://getnikola.com/">Nikola</a></strong>, <a href="http://nginx.org/">nginx</a> and <a href="https://www.digitalocean.com/?refcode=7983689b2ecc">DigitalOcean</a><br>
copyright © 2009–2017 <a href="/contact/">Chris Warrick</a><br><a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC
BY-NC-SA</a>, unless stated otherwise</p>
            
        </footer>
</div>


            <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script><script src="/assets/js/all.js"></script><script>jQuery("a.image-reference").colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-11937989-1', 'chriswarrick.com');
  ga('require', 'displayfeatures');
  ga('send', 'pageview');

</script>
</body>
</html>